<h5>
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;
import java.util.*;

public class HellmanClient {
    
    private static long power(long a, long b, long p){
        if (b == 1)
            return a;
        else
            return (((long)Math.pow(a, b)) % p);
    }
    
    public static void main(String[] args) throws Exception{
        Socket s = new Socket("localhost", 4000);
        PrintWriter out = new PrintWriter(s.getOutputStream(), true);
        BufferedReader in = new BufferedReader(new InputStreamReader(s.getInputStream()));
        Scanner sc = new Scanner(System.in);
        long P,G,a,x,y,sk=0;
        
        System.out.print("Enter Prime number, P : ");
        P = sc.nextLong();
        System.out.print("Enter Primitive Modulo, G : ");
        G = sc.nextLong();
        System.out.print("Enter Client's Private Key, a : ");
        a = sc.nextLong();
        out.println(P);
        out.println(G);
        x = power(G, a, P);
        out.println(x);
        y = Long.parseLong(in.readLine());
        System.out.println("\nReceived KB : " + y);
        sk = power(y, a, P);
        System.out.println("\nShared Key : " + sk);
            
        s.close();
        sc.close();
        in.close();
        out.close();
    }
    
}
</h5>
