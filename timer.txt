1. Timer Delay program with no interrupts :

ALGORITHM:

1. Set the port 0 as an output pin

2. Set the value of pin1 of port 0 as high

3. Invoke the timer function to generate delay

4. Set the value of pin1 of port 0 as low

5. Invoke the timer function to generate delay

6. Repeat steps 2-5 infinitely

7. In the timer function, set the value of TMOD to use Mode 1 of Timer 0

8. Set the initial value for the timer in TH0 and TL0

9. Start the timer by setting TR0 to 1

10. Watch for rollover by checking TF0

11. If TF0 becomes 1, stop timer by setting TR0 to 0 and reset flag TF0

CODE:

org 0h

mov P0, #00h

test:

setb P0.1

call timer

clr P0.1

call timer

sjmp test

timer:

mov TMOD, #01h

mov TH0, #04h

mov TL0, #04h

setb TR0

jnb TF0, $

clr TR0

ret

end

2. Timer Delay program with interrupts :

ALGORITHM:

1. Set the port 0 as an output pin

2. Set the value of pin1 of port 0 as high

3. Invoke the timer function to generate delay

4. Set the value of pin1 of port 0 as low

5. Invoke the timer function to generate delay

6. Repeat steps 2-5 infinitely

7. In the timer function, set the value of TMOD to use Mode 1 of Timer 0

8. Set the initial value for the timer in TH0 and TL0

9. Start the timer by setting TR0 to 1

10. Watch for rollover by checking TF0

11. If TF0 becomes 1, stop timer by setting TR0 to 0 and reset flag TF0

CODE:

org 0h

ljmp 200h

org 0bh

ljmp isr

reti

org 100h

isr:

cpl P1.1

mov TH0, #0FFh

mov TL0, #04h

setb TR0

reti

org 200h

main:
mov P1,#00h

mov IE,#82h

mov TMOD, #01h

reset:

mov TH0, #0FFh

mov TL0, #04h

setb TR0

end
